<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>weChat | 嗨，毛毛</title><meta name="description" content="一、云开发1、云开发初始化—yun0813(1) 开通云开发 界面&#x3D;&#x3D;》云开发&#x3D;&#x3D;》开通  (2) 创建云目录 project.config.json文件中添加配置(description的下面) 带“&#x2F;” &quot;cloudfunctionRoot&quot;: &quot;&#x2F;cloud&quot;  创建目录  +&#x3D;&#x3D;》目录&#x3D;&#x3D;》cloud     (3) 配置云开发环境初始化 位置：app.js  配置代码 &#x2F;&#x2F; 云开发初始化"><meta name="keywords" content="JAVA,'博客','算法'"><meta name="author" content="Code Mao"><meta name="copyright" content="Code Mao"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/2020/08/30/weChat/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="weChat"><meta property="og:url" content="http://yoursite.com/2020/08/30/weChat/"><meta property="og:site_name" content="嗨，毛毛"><meta property="og:description" content="一、云开发1、云开发初始化—yun0813(1) 开通云开发 界面&#x3D;&#x3D;》云开发&#x3D;&#x3D;》开通  (2) 创建云目录 project.config.json文件中添加配置(description的下面) 带“&#x2F;” &quot;cloudfunctionRoot&quot;: &quot;&#x2F;cloud&quot;  创建目录  +&#x3D;&#x3D;》目录&#x3D;&#x3D;》cloud     (3) 配置云开发环境初始化 位置：app.js  配置代码 &#x2F;&#x2F; 云开发初始化"><meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><meta property="article:published_time" content="2020-08-30T06:47:12.854Z"><meta property="article:modified_time" content="2020-08-30T06:44:05.656Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="Oracle" href="http://yoursite.com/2020/09/20/Oracle/"><link rel="next" title="小程序---如何上传代码？" href="http://yoursite.com/2020/08/26/%E5%B0%8F%E7%A8%8B%E5%BA%8F---%E5%A6%82%E4%BD%95%E4%B8%8A%E4%BC%A0%E4%BB%A3%E7%A0%81%EF%BC%9F/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: {"languages":{"author":"作者: Code Mao","link":"链接: ","source":"来源: 嗨，毛毛","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isSidebar: true,
  postUpdate: '2020-08-30 14:44:05'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">16</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 古语</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一、云开发"><span class="toc-number">1.</span> <span class="toc-text">一、云开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、云开发初始化—yun0813"><span class="toc-number">1.1.</span> <span class="toc-text">1、云开发初始化—yun0813</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-开通云开发"><span class="toc-number">1.1.1.</span> <span class="toc-text">(1) 开通云开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-创建云目录"><span class="toc-number">1.1.2.</span> <span class="toc-text">(2) 创建云目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-配置云开发环境初始化"><span class="toc-number">1.1.3.</span> <span class="toc-text">(3) 配置云开发环境初始化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、云数据库的增删改查—yun0609"><span class="toc-number">1.2.</span> <span class="toc-text">2、云数据库的增删改查—yun0609</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-云开发初始化"><span class="toc-number">1.2.1.</span> <span class="toc-text">(1) 云开发初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-增、删、改、查"><span class="toc-number">1.2.2.</span> <span class="toc-text">(2) 增、删、改、查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-直接获取云数据库的缺点"><span class="toc-number">1.2.3.</span> <span class="toc-text">(3) 直接获取云数据库的缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、云函数—yun0908"><span class="toc-number">1.3.</span> <span class="toc-text">3、云函数—yun0908</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-计算求和的云函数"><span class="toc-number">1.3.1.</span> <span class="toc-text">(1) 计算求和的云函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-获取小程序用户的openid"><span class="toc-number">1.3.2.</span> <span class="toc-text">(2) 获取小程序用户的openid</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-利用云函数获取数据库数据"><span class="toc-number">1.3.3.</span> <span class="toc-text">(3) 利用云函数获取数据库数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、云存储—test1013"><span class="toc-number">1.4.</span> <span class="toc-text">4、云存储—test1013</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-作用"><span class="toc-number">1.4.1.</span> <span class="toc-text">(1) 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-选择并上传到云存储图片并展示"><span class="toc-number">1.4.2.</span> <span class="toc-text">(2) 选择并上传到云存储图片并展示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-选择视频并上传到云储存"><span class="toc-number">1.4.3.</span> <span class="toc-text">(3) 选择视频并上传到云储存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、选择文件（excel）上传到云存储并打开"><span class="toc-number">1.4.4.</span> <span class="toc-text">4、选择文件（excel）上传到云存储并打开</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、列表展示—yun1112"><span class="toc-number">1.5.</span> <span class="toc-text">5、列表展示—yun1112</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-直接通过数据库获取数据的局限性-》page-index"><span class="toc-number">1.5.1.</span> <span class="toc-text">(1)  直接通过数据库获取数据的局限性&#x3D;&#x3D;》page&#x2F;index</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-通过云函数获取数据库数据的局限性-gt-page-yun"><span class="toc-number">1.5.2.</span> <span class="toc-text">(2) 通过云函数获取数据库数据的局限性&#x3D;&#x3D;&gt;page&#x2F;yun</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6、分页—分页"><span class="toc-number">1.6.</span> <span class="toc-text">6、分页—分页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-核心"><span class="toc-number">1.6.1.</span> <span class="toc-text">(1) 核心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-实例"><span class="toc-number">1.6.2.</span> <span class="toc-text">(2) 实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7、登录注册—login1204—user"><span class="toc-number">1.7.</span> <span class="toc-text">7、登录注册—login1204—user</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-注册—index"><span class="toc-number">1.7.1.</span> <span class="toc-text">(1) 注册—index</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-登录—login"><span class="toc-number">1.7.2.</span> <span class="toc-text">(2) 登录—login</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-首页—home"><span class="toc-number">1.7.3.</span> <span class="toc-text">(3) 首页—home</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-个人中心页"><span class="toc-number">1.7.4.</span> <span class="toc-text">(4) 个人中心页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-小程序上传内容-gt-2M"><span class="toc-number">1.7.5.</span> <span class="toc-text">(9)小程序上传内容&gt;2M</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-根据时间，小于等于3小时记单量为1，否则加1"><span class="toc-number">1.7.6.</span> <span class="toc-text">(10) 根据时间，小于等于3小时记单量为1，否则加1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-input只能输入数字"><span class="toc-number">1.7.7.</span> <span class="toc-text">(11) input只能输入数字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-查询数据的时候排序"><span class="toc-number">1.7.8.</span> <span class="toc-text">(12)  查询数据的时候排序</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二、实战项目—demo"><span class="toc-number">2.</span> <span class="toc-text">二、实战项目—demo</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、-input-和-textarea"><span class="toc-number">2.1.</span> <span class="toc-text">1、 input 和 textarea</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、-页面跳转传参"><span class="toc-number">2.2.</span> <span class="toc-text">2、 页面跳转传参</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、-重置页面的方法"><span class="toc-number">2.3.</span> <span class="toc-text">3、 重置页面的方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、-data-的用法"><span class="toc-number">2.4.</span> <span class="toc-text">4、 data-的用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、-form的用法"><span class="toc-number">2.5.</span> <span class="toc-text">5、 form的用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6、-手机号正则—2020"><span class="toc-number">2.6.</span> <span class="toc-text">6、 手机号正则—2020</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7、picker的用法"><span class="toc-number">2.7.</span> <span class="toc-text">7、picker的用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8、-页面手机屏幕"><span class="toc-number">2.8.</span> <span class="toc-text">8、 页面手机屏幕</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9、-校验表单中数据是否填写完整"><span class="toc-number">2.9.</span> <span class="toc-text">9、 校验表单中数据是否填写完整</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10、-单选按钮—test"><span class="toc-number">2.10.</span> <span class="toc-text">10、 单选按钮—test</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11、-input-文字显示一半"><span class="toc-number">2.11.</span> <span class="toc-text">11、 input 文字显示一半</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12、-下拉触底函数不触发"><span class="toc-number">2.12.</span> <span class="toc-text">12、 下拉触底函数不触发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13、-开发时注意"><span class="toc-number">2.13.</span> <span class="toc-text">13、 开发时注意</span></a></li></ol></li></ol></div></div></div><div class="code-close" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">嗨，毛毛</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 古语</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">weChat</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-08-30 14:47:12"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2020-08-30</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-08-30 14:44:05"><i class="fas fa-history fa-fw"></i> 更新于 2020-08-30</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="一、云开发"><a href="#一、云开发" class="headerlink" title="一、云开发"></a>一、云开发</h1><h2 id="1、云开发初始化—yun0813"><a href="#1、云开发初始化—yun0813" class="headerlink" title="1、云开发初始化—yun0813"></a>1、云开发初始化—yun0813</h2><h3 id="1-开通云开发"><a href="#1-开通云开发" class="headerlink" title="(1) 开通云开发"></a>(1) 开通云开发</h3><ul>
<li>界面==》云开发==》开通</li>
</ul>
<h3 id="2-创建云目录"><a href="#2-创建云目录" class="headerlink" title="(2) 创建云目录"></a>(2) 创建云目录</h3><ul>
<li><p>project.config.json文件中添加配置(description的下面) <strong>带“/”</strong></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"cloudfunctionRoot": "/cloud"</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建目录</p>
<ul>
<li>+==》目录==》cloud</li>
</ul>
<p><img src= "/img/loading.gif" data-src="/2020/08/30/weChat/image_01.png" alt></p>
</li>
</ul>
<h3 id="3-配置云开发环境初始化"><a href="#3-配置云开发环境初始化" class="headerlink" title="(3) 配置云开发环境初始化"></a>(3) 配置云开发环境初始化</h3><ul>
<li><p>位置：app.js</p>
</li>
<li><p>配置代码</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 云开发初始化</span></span><br><span class="line">    wx.cloud.init(&#123;</span><br><span class="line">      env:<span class="string">"codemao-7hcrz"</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-src="/2020/08/30/weChat/image_02.png" alt></p>
</li>
</ul>
<h2 id="2、云数据库的增删改查—yun0609"><a href="#2、云数据库的增删改查—yun0609" class="headerlink" title="2、云数据库的增删改查—yun0609"></a>2、云数据库的增删改查—yun0609</h2><h3 id="1-云开发初始化"><a href="#1-云开发初始化" class="headerlink" title="(1) 云开发初始化"></a>(1) 云开发初始化</h3><h3 id="2-增、删、改、查"><a href="#2-增、删、改、查" class="headerlink" title="(2) 增、删、改、查"></a>(2) 增、删、改、查</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- 添加注释 --&gt;</span><br><span class="line">&lt;input placeholder&#x3D;&quot;输入名字&quot; bindinput&#x3D;&quot;addName&quot;&gt;&lt;&#x2F;input&gt;</span><br><span class="line">&lt;input placeholder&#x3D;&quot;输入年龄&quot; bindinput&#x3D;&quot;addAge&quot;&gt;&lt;&#x2F;input&gt;</span><br><span class="line">&lt;button bindtap &#x3D; &quot;addData&quot; type&#x3D;&quot;primary&quot;&gt;添加数据&lt;&#x2F;button&gt;</span><br><span class="line">&lt;button bindtap &#x3D; &quot;getData&quot; type&#x3D;&quot;primary&quot;&gt;查询数据&lt;&#x2F;button&gt;</span><br><span class="line">&lt;!-- 删除数据 --&gt;</span><br><span class="line">&lt;input placeholder&#x3D;&quot;请输入要输入的ID&quot; bindinput&#x3D;&quot;delDataInput&quot;&gt;&lt;&#x2F;input&gt;</span><br><span class="line">&lt;button bindtap &#x3D; &quot;delData&quot; type&#x3D;&quot;primary&quot;&gt;删除数据&lt;&#x2F;button&gt;</span><br><span class="line">&lt;!-- 更新数据 --&gt;</span><br><span class="line">&lt;input placeholder&#x3D;&quot;请输入想要更新的ID&quot; bindinput&#x3D;&quot;udpDataInput&quot;&gt;&lt;&#x2F;input&gt;</span><br><span class="line">&lt;input placeholder&#x3D;&quot;请输入更新的年龄&quot; bindinput&#x3D;&quot;udpAge&quot;&gt;&lt;&#x2F;input&gt; </span><br><span class="line">&lt;button bindtap &#x3D; &quot;udpData&quot; type&#x3D;&quot;primary&quot;&gt;更新数据&lt;&#x2F;button&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> DB = wx.cloud.database().collection(<span class="string">"list"</span>)</span><br><span class="line"><span class="keyword">let</span> name = <span class="string">""</span></span><br><span class="line"><span class="keyword">let</span> age = <span class="string">""</span></span><br><span class="line"><span class="keyword">let</span> id = <span class="string">""</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  <span class="comment">// 获取用户输入的name</span></span><br><span class="line">  addName(event)&#123;</span><br><span class="line">    name = event.detail.value;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 获取用户输入的age</span></span><br><span class="line">  addAge(event) &#123;</span><br><span class="line">    age = event.detail.value;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 要删除的ID</span></span><br><span class="line">  delDataInput(event)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"要删除的id"</span>,event.detail.value)</span><br><span class="line">    id = event.detail.value</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 要更新的ID</span></span><br><span class="line">  udpDataInput(event) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"要删除的id"</span>, event.detail.value)</span><br><span class="line">    id = event.detail.value</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 要更新的年龄</span></span><br><span class="line">  udpAge(event) &#123;</span><br><span class="line">    age = event.detail.value;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 添加数据</span></span><br><span class="line">  addData()&#123;</span><br><span class="line">    DB.add(&#123;</span><br><span class="line">      data:&#123;</span><br><span class="line">        name: name,</span><br><span class="line">        age: age</span><br><span class="line">      &#125;,</span><br><span class="line">      success(res)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"添加成功"</span>,res)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail(res)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"添加失败"</span>,res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 删除数据</span></span><br><span class="line">  delData() &#123;</span><br><span class="line">    DB.doc(id).remove(&#123;</span><br><span class="line">      success(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"删除成功"</span>, res)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"删除数据失败"</span>, res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 查询数据</span></span><br><span class="line">  getData()&#123;</span><br><span class="line">    DB.get(&#123;</span><br><span class="line">      success(res)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"查询数据成功"</span>, res)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail(res)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"查询数据失败"</span>, res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  udpData()&#123;</span><br><span class="line">    DB.doc(id).update(&#123;</span><br><span class="line">      data: &#123;</span><br><span class="line">        age: age</span><br><span class="line">      &#125;,</span><br><span class="line">      success(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"更新成功"</span>, res)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"更新失败"</span>, res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="3-直接获取云数据库的缺点"><a href="#3-直接获取云数据库的缺点" class="headerlink" title="(3) 直接获取云数据库的缺点"></a>(3) 直接获取云数据库的缺点</h3><ol>
<li><p>会受到权限的限制，只能获取自己用直接添加的数据，不能获取到手动添加的数据</p>
</li>
<li><p>怎么解决？</p>
<ul>
<li><p>点击 云开发==》数据库-==》表名称==》权限设置改成第一个，所有用户可读写</p>
<p><img src= "/img/loading.gif" data-src="/2020/08/30/weChat/image_03.png" alt></p>
</li>
</ul>
</li>
</ol>
<h2 id="3、云函数—yun0908"><a href="#3、云函数—yun0908" class="headerlink" title="3、云函数—yun0908"></a>3、云函数—yun0908</h2><h3 id="1-计算求和的云函数"><a href="#1-计算求和的云函数" class="headerlink" title="(1) 计算求和的云函数"></a>(1) 计算求和的云函数</h3><ul>
<li><p>云函数初始化</p>
</li>
<li><p>创建云文件夹</p>
<ul>
<li><p>+==》目录==》cloud</p>
</li>
<li><p>配置project.config.json文件中添加配置(description的下面) <strong>带“/”</strong></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"cloudfunctionRoot": "/cloud"</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>创建云函数（add）</p>
<ul>
<li>右键cloud==》新建node.js云函数</li>
</ul>
</li>
<li><p>编写云函数</p>
<ul>
<li><p>书写代码—add/index.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 云函数入口文件</span></span><br><span class="line"><span class="keyword">const</span> cloud = <span class="built_in">require</span>(<span class="string">'wx-server-sdk'</span>)</span><br><span class="line"></span><br><span class="line">cloud.init()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 云函数入口函数</span></span><br><span class="line">exports.main = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> a = event.a;</span><br><span class="line">  <span class="keyword">let</span> b = event.b;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>上传云函数</p>
<ul>
<li>右键add==&gt;上传并部署云函数依赖不上传node…</li>
</ul>
</li>
</ul>
</li>
<li><p>调用云函数 wx.cloud.callFunction({})</p>
<ul>
<li><p>pages/index/index.wxml</p>
</li>
<li><p>pages/index/index.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.wxml</span></span><br><span class="line">&lt;button bindtap=<span class="string">"qiuhe"</span>&gt;云函数获取加法&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/index.js</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ 第一个云函数</span></span><br><span class="line"><span class="regexp">  qiuhe()&#123;</span></span><br><span class="line"><span class="regexp">    wx.cloud.callFunction(&#123;</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/ 云函数的名称</span></span><br><span class="line"><span class="regexp">      name:"add",</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/ 和云函数接受的数据保持一致</span></span><br><span class="line"><span class="regexp">      data:&#123;</span></span><br><span class="line"><span class="regexp">        a: 9,</span></span><br><span class="line"><span class="regexp">        b: 3</span></span><br><span class="line"><span class="regexp">      &#125;,</span></span><br><span class="line"><span class="regexp">      success(res)&#123;</span></span><br><span class="line"><span class="regexp">        console.log("请求成功",res)</span></span><br><span class="line"><span class="regexp">      &#125;,</span></span><br><span class="line"><span class="regexp">      fail(res)&#123;</span></span><br><span class="line"><span class="regexp">        console.log("请求失败",res)</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<h3 id="2-获取小程序用户的openid"><a href="#2-获取小程序用户的openid" class="headerlink" title="(2) 获取小程序用户的openid"></a>(2) 获取小程序用户的openid</h3><ol>
<li><p>云函数初始化</p>
</li>
<li><p>新建云函数文件并配置json文件</p>
</li>
<li><p>新建node.js函数—默认就是获取用户openid</p>
<ul>
<li>右键cloud==》新建node.js文件==》取名叫getopenid</li>
</ul>
</li>
<li><p>调用云函数文件wx.cloud.callFunction</p>
<ul>
<li>位置：pages/index/index.js+index.wxml</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;index.wxml</span><br><span class="line">&lt;button bindtap&#x3D;&quot;getOpenId&quot;&gt;获取用户openid&lt;&#x2F;button&gt;</span><br><span class="line">&#x2F;&#x2F;index.js</span><br><span class="line">Page(&#123;</span><br><span class="line">  &#x2F;&#x2F; 获取用户openid</span><br><span class="line">  getOpenId()&#123;</span><br><span class="line">    wx.cloud.callFunction(&#123;</span><br><span class="line">      name:&quot;getopenid&quot;,</span><br><span class="line">      success(res)&#123;</span><br><span class="line">        console.log(&quot;获取openid成功&quot;,res.result.openid)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail(res)&#123;</span><br><span class="line">        console.log(&quot;获取openid失败&quot;,res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="5">
<li><p>获取openid的作用</p>
<ul>
<li>可以唯一标识用户</li>
</ul>
</li>
<li><p>唯一表示用户的方法</p>
<ul>
<li>用户的手机号</li>
<li>openid</li>
</ul>
</li>
</ol>
<h3 id="3-利用云函数获取数据库数据"><a href="#3-利用云函数获取数据库数据" class="headerlink" title="(3) 利用云函数获取数据库数据"></a>(3) 利用云函数获取数据库数据</h3><ol>
<li><p>为什么要用云函数获取数据那？</p>
<ul>
<li>云函数获取数据库数据可以突破20条的限制</li>
<li>云函数获取数据库不受数据库表的权限控制</li>
<li>云函数可以实现的功能更多</li>
</ul>
</li>
<li><p>云函数获取数据的具体流程</p>
<ul>
<li><p>云开发初始化+创建云开发文件并配置</p>
</li>
<li><p>新建云函数文件==》getshuju</p>
</li>
<li><p>编写云函数文件==》getshuju/index.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 云函数入口文件</span></span><br><span class="line"><span class="keyword">const</span> cloud = <span class="built_in">require</span>(<span class="string">'wx-server-sdk'</span>)</span><br><span class="line"><span class="comment">// 如果报找不到资源的错误就在写一下环境ID</span></span><br><span class="line">cloud.init(&#123;</span><br><span class="line">  env: <span class="string">"codemao-7hcrz"</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 云函数入口函数</span></span><br><span class="line">exports.main = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> cloud.database().collection(<span class="string">"users"</span>).get(&#123;&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ol>
<pre><code>- 调用云函数文件==》pages/index/index.js

  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.wxml</span></span><br><span class="line">&lt;button bindtap=<span class="string">"yunhanshu"</span>&gt;云函数获取数据&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/index.js</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ 云函数获取数据</span></span><br><span class="line"><span class="regexp">  yunhanshu()&#123;</span></span><br><span class="line"><span class="regexp">    wx.cloud.callFunction(&#123;</span></span><br><span class="line"><span class="regexp">      name: "getshuju",</span></span><br><span class="line"><span class="regexp">      success(res)&#123;</span></span><br><span class="line"><span class="regexp">        console.log("云函数获取数据成功", res.result.data)</span></span><br><span class="line"><span class="regexp">      &#125;,</span></span><br><span class="line"><span class="regexp">      fail(res)&#123;</span></span><br><span class="line"><span class="regexp">        console.log("云函数获取数据失败",res)</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure></code></pre><h2 id="4、云存储—test1013"><a href="#4、云存储—test1013" class="headerlink" title="4、云存储—test1013"></a>4、云存储—test1013</h2><h3 id="1-作用"><a href="#1-作用" class="headerlink" title="(1) 作用"></a>(1) 作用</h3><pre><code>1. 存储各种文件，并下载</code></pre><h3 id="2-选择并上传到云存储图片并展示"><a href="#2-选择并上传到云存储图片并展示" class="headerlink" title="(2) 选择并上传到云存储图片并展示"></a>(2) 选择并上传到云存储图片并展示</h3><ol>
<li><p>配置云开发环境(init)</p>
</li>
<li><p>选择图片page/index/index.wxml+index.js</p>
<ul>
<li><p>wxml</p>
</li>
<li><p>js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.wxml</span></span><br><span class="line">&lt;button bindtap=<span class="string">"upload"</span>&gt;上传图片&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;image src="&#123;&#123;imgUrl&#125;&#125;"&gt;&lt;/im</span>age&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">    imgUrl: <span class="string">""</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 选择文件</span></span><br><span class="line">  upload()&#123;</span><br><span class="line">    <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">// 官方文档  API==》媒体==》图片==》chooseimage 复制的</span></span><br><span class="line">    <span class="comment">//https://developers.weixin.qq.com/miniprogram/dev/api/media/image/wx.chooseImage.html</span></span><br><span class="line">    wx.chooseImage(&#123;</span><br><span class="line">      count: <span class="number">1</span>,</span><br><span class="line">      sizeType: [<span class="string">'original'</span>, <span class="string">'compressed'</span>],</span><br><span class="line">      sourceType: [<span class="string">'album'</span>, <span class="string">'camera'</span>],</span><br><span class="line">      success(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"选择成功"</span>, res)</span><br><span class="line">        that.uploadImg(res.tempFilePaths[<span class="number">0</span>])</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 上传图片</span></span><br><span class="line">  uploadImg(fileUrl)&#123;</span><br><span class="line">    <span class="comment">// 官方文档==》云开发==》存储==》API</span></span><br><span class="line">    <span class="comment">// https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/storage/api.html</span></span><br><span class="line">    wx.cloud.uploadFile(&#123;</span><br><span class="line">      <span class="comment">// js获取时间戳</span></span><br><span class="line">      cloudPath: <span class="keyword">new</span> <span class="built_in">Date</span>().getTime() + <span class="string">'codemao.png'</span>, <span class="comment">// 上传至云端的路径</span></span><br><span class="line">      filePath: fileUrl, <span class="comment">// 小程序临时文件路径</span></span><br><span class="line">      success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 返回文件 ID</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"上传成功"</span>,res.fileID)</span><br><span class="line">        <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">          imgUrl: res.fileID</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail: <span class="built_in">console</span>.error</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ol>
<h3 id="3-选择视频并上传到云储存"><a href="#3-选择视频并上传到云储存" class="headerlink" title="(3) 选择视频并上传到云储存"></a>(3) 选择视频并上传到云储存</h3><ol>
<li><p>云开发环境初始化</p>
</li>
<li><p>选择视频并上传到云存储</p>
</li>
<li><p>展示图片</p>
<ul>
<li><p>wxml和js==&gt;page/index/index.wxml+index.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.wxml</span></span><br><span class="line">&lt;button bindtap=<span class="string">"uploadVideo"</span>&gt;上传视频&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;video src="&#123;&#123;videoUrl&#125;&#125;" controls="false"&gt;&lt;/</span>video&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">    videoUrl: <span class="string">"cloud://codemao-7hcrz.636f-codemao-7hcrz-1301171692/视频.mp4"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  uploadVideo()&#123;</span><br><span class="line">    <span class="comment">// 官方文档==》API==&gt;媒体==》视频</span></span><br><span class="line">    <span class="comment">// https://developers.weixin.qq.com/miniprogram/dev/api/media/video/wx.chooseVideo.html</span></span><br><span class="line">    wx.chooseVideo(&#123;</span><br><span class="line">      sourceType: [<span class="string">'album'</span>, <span class="string">'camera'</span>],</span><br><span class="line">      maxDuration: <span class="number">60</span>,<span class="comment">//视频时长 s</span></span><br><span class="line">      camera: <span class="string">'back'</span>,</span><br><span class="line">      success(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"选择视频成功"</span>, res.tempFilePath)</span><br><span class="line">        wx.cloud.uploadFile(&#123;</span><br><span class="line">          <span class="comment">// js获取时间戳</span></span><br><span class="line">          cloudPath: <span class="string">'视频.mp4'</span>, <span class="comment">// 上传至云端的路径</span></span><br><span class="line">          filePath: res.tempFilePath, <span class="comment">// 小程序临时文件路径</span></span><br><span class="line">          success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 返回文件 ID</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"上传视频成功"</span>, res.fileID)</span><br><span class="line">          &#125;,</span><br><span class="line">          fail: <span class="built_in">console</span>.error</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="4、选择文件（excel）上传到云存储并打开"><a href="#4、选择文件（excel）上传到云存储并打开" class="headerlink" title="4、选择文件（excel）上传到云存储并打开"></a>4、选择文件（excel）上传到云存储并打开</h3><ol>
<li><p>初始化云函数</p>
</li>
<li><p>选择文件并上传到云存储</p>
</li>
<li><p>展示图片</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.wxml</span></span><br><span class="line">&lt;button bindtap=<span class="string">"uploadExcel"</span>&gt;上传excel文件&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;button bindtap="openExcel"&gt;下载并打开excel文件&lt;/</span>button&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  <span class="comment">// 下载并打开excel文件</span></span><br><span class="line">  openExcel()&#123;</span><br><span class="line">    <span class="comment">// 官方文档==》云开发==》存储==》API==&gt;downLoad</span></span><br><span class="line">    wx.cloud.downloadFile(&#123;</span><br><span class="line">      fileID: <span class="string">'cloud://codemao-7hcrz.636f-codemao-7hcrz-1301171692/aaa.xlsx'</span>, <span class="comment">// 文件 ID</span></span><br><span class="line">      success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 返回临时文件路径</span></span><br><span class="line">        <span class="built_in">console</span>.log(res.tempFilePath)</span><br><span class="line">        <span class="comment">// 打开文件</span></span><br><span class="line">        <span class="comment">//https://developers.weixin.qq.com/miniprogram/dev/api/file/wx.openDocument.html</span></span><br><span class="line">        wx.openDocument(&#123;</span><br><span class="line">          filePath: res.tempFilePath,</span><br><span class="line">          success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'打开文档成功'</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail: <span class="built_in">console</span>.error</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 上传excel文件</span></span><br><span class="line">  uploadExcel()&#123;</span><br><span class="line">    <span class="comment">// 官方文档==》API==》图片==》chooseMessageFile...</span></span><br><span class="line">    <span class="comment">//https://developers.weixin.qq.com/miniprogram/dev/api/media/image/wx.chooseMessageFile.html</span></span><br><span class="line">    <span class="comment">// 上传所有文件 例如 excel，word等等</span></span><br><span class="line">    wx.chooseMessageFile(&#123;</span><br><span class="line">     </span><br><span class="line">      count: <span class="number">1</span>,</span><br><span class="line">      type: <span class="string">'all'</span>,</span><br><span class="line">      success(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"选择文件成功"</span>, res)</span><br><span class="line">        <span class="comment">// tempFilePath可以作为img标签的src属性显示图片</span></span><br><span class="line">        <span class="keyword">const</span> tempFilePaths = res.tempFiles[<span class="number">0</span>].path</span><br><span class="line">        wx.cloud.uploadFile(&#123;</span><br><span class="line">          cloudPath: <span class="string">'aaa.xlsx'</span>, <span class="comment">// 上传至云端的路径</span></span><br><span class="line">          filePath: tempFilePaths, <span class="comment">// 小程序临时文件路径</span></span><br><span class="line">          success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 返回文件 ID</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"上传文件成功"</span>, res.fileID)</span><br><span class="line">          &#125;,</span><br><span class="line">          fail: <span class="built_in">console</span>.error</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



</li>
</ol>
</li>
</ul>
</li>
</ol>
<h2 id="5、列表展示—yun1112"><a href="#5、列表展示—yun1112" class="headerlink" title="5、列表展示—yun1112"></a>5、列表展示—yun1112</h2><h3 id="1-直接通过数据库获取数据的局限性-》page-index"><a href="#1-直接通过数据库获取数据的局限性-》page-index" class="headerlink" title="(1)  直接通过数据库获取数据的局限性==》page/index"></a>(1)  直接通过数据库获取数据的局限性==》page/index</h3><ol>
<li><p>获取数据库数据</p>
<ul>
<li>集合的名称是userlist</li>
</ul>
</li>
<li><p><strong>展示页面</strong>==》wx:for  item.age</p>
</li>
<li><p>缺点</p>
<ul>
<li>只能获取20条数据</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.wxml</span></span><br><span class="line">&lt;button bindtap=<span class="string">"getData"</span>&gt;获取云数据库数据&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;view wx:for="&#123;&#123;dataList&#125;&#125;"&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="itemRoot"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view&gt;&#123;&#123;item.name&#125;&#125;&lt;/</span>view&gt;</span><br><span class="line">    &lt;view&gt;&#123;&#123;item._id&#125;&#125;&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view&gt;&#123;&#123;item.address&#125;&#125;&lt;/</span>view&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.wxss</span></span><br><span class="line">.itemRoot&#123;</span><br><span class="line">  background: gainsboro;</span><br><span class="line">  border: <span class="number">1</span>px solid red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">    dataList:[]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 获取云数据库数据</span></span><br><span class="line">  getData(res)&#123;</span><br><span class="line">    <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">    wx.cloud.database().collection(<span class="string">"userlist"</span>).get(&#123;</span><br><span class="line">      success(res)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"获取数据成功"</span>,res)</span><br><span class="line">        that.setData(&#123;</span><br><span class="line">          dataList: res.data</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail(res)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"获取数据失败"</span>,res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h3 id="2-通过云函数获取数据库数据的局限性-gt-page-yun"><a href="#2-通过云函数获取数据库数据的局限性-gt-page-yun" class="headerlink" title="(2) 通过云函数获取数据库数据的局限性==&gt;page/yun"></a>(2) 通过云函数获取数据库数据的局限性==&gt;page/yun</h3><ol>
<li><p>获取数据库数据</p>
<ul>
<li>云函数的名称是getList</li>
<li>集合的名称是userlist</li>
</ul>
</li>
<li><p><strong>展示页面</strong></p>
</li>
<li><p>缺点</p>
<ul>
<li>只能获取100条数据</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//yun.wxml</span></span><br><span class="line">&lt;button bindtap=<span class="string">"getData"</span>&gt;云函数获取云数据库数据&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;view wx:for="&#123;&#123;dataList&#125;&#125;" wx:key="item"&gt;</span></span><br><span class="line"><span class="regexp">  &lt;view class="itemRoot"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view&gt;&#123;&#123;item.name&#125;&#125;&lt;/</span>view&gt;</span><br><span class="line">    &lt;view&gt;&#123;&#123;item._id&#125;&#125;&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">    &lt;view&gt;&#123;&#123;item.address&#125;&#125;&lt;/</span>view&gt;</span><br><span class="line">  &lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//yun.wxss</span></span><br><span class="line">.itemRoot&#123;</span><br><span class="line">  background: gainsboro;</span><br><span class="line">  border: <span class="number">1</span>px solid red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//yun.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    dataList: []</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 获取云数据库数据</span></span><br><span class="line">  getData(res) &#123;</span><br><span class="line">    <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">    wx.cloud.callFunction(&#123;</span><br><span class="line">      name: <span class="string">"getList"</span>,</span><br><span class="line">      success(res)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"请求成功"</span>,res)</span><br><span class="line">        that.setData(&#123;</span><br><span class="line">          dataList: res.result.data</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"请求失败"</span>, res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//getList</span></span><br><span class="line"><span class="comment">// 云函数入口文件</span></span><br><span class="line"><span class="keyword">const</span> cloud = <span class="built_in">require</span>(<span class="string">'wx-server-sdk'</span>)</span><br><span class="line"></span><br><span class="line">cloud.init(&#123;</span><br><span class="line">  env: <span class="string">"codemao-7hcrz"</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 云函数入口函数</span></span><br><span class="line">exports.main = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> cloud.database().collection(<span class="string">"userlist"</span>).get(&#123;</span><br><span class="line">    success(res)&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"云函数获取数据成功"</span>,res)</span><br><span class="line">    &#125;,</span><br><span class="line">    fail(res)&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"云函数获取数据失败"</span>,res)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h2 id="6、分页—分页"><a href="#6、分页—分页" class="headerlink" title="6、分页—分页"></a>6、分页—分页</h2><h3 id="1-核心"><a href="#1-核心" class="headerlink" title="(1) 核心"></a>(1) 核心</h3><ul>
<li>skip(数字)：从该数据之后开始显示</li>
<li>limit(数字)：限制多少数量</li>
<li>onReachBottom: function：页面上拉触发函数</li>
</ul>
<h3 id="2-实例"><a href="#2-实例" class="headerlink" title="(2) 实例"></a>(2) 实例</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//app.js</span></span><br><span class="line"><span class="comment">//app.js</span></span><br><span class="line">App(&#123;</span><br><span class="line">  onLaunch: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    wx.cloud.init(&#123;</span><br><span class="line">      env: <span class="string">"codemao-7hcrz"</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  globalData: &#123;</span><br><span class="line">    userInfo: <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.wxml</span></span><br><span class="line">&lt;block wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123;list&#125;&#125;"</span> wx:key=<span class="string">"index"</span>&gt;</span><br><span class="line">  &lt;view <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;&#123;&#123;item.num&#125;&#125;&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>block&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.wxss</span></span><br><span class="line">.item&#123;</span><br><span class="line">  border: <span class="number">1</span>px solid gainsboro;</span><br><span class="line">  height: <span class="number">80</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">let</span> totalNum = <span class="number">-1</span>;</span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  data: &#123;</span><br><span class="line">    list: []</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 加载数据</span></span><br><span class="line">  getDataList()&#123;</span><br><span class="line">    <span class="keyword">let</span> len = <span class="keyword">this</span>.data.list.length;</span><br><span class="line">    <span class="keyword">if</span> (totalNum == len)&#123;</span><br><span class="line">      wx.showToast(&#123;</span><br><span class="line">        title: <span class="string">'数据加载完毕'</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    wx.showLoading(&#123;</span><br><span class="line">      title: <span class="string">'加载中'</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">   </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"list的长度"</span>,len)</span><br><span class="line">    wx.cloud.database().collection(<span class="string">'list'</span>)</span><br><span class="line">    .skip(len)</span><br><span class="line">    .get()</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"获取成功"</span>, res)</span><br><span class="line">      <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">        list: <span class="keyword">this</span>.data.list.concat(res.data)</span><br><span class="line">      &#125;)</span><br><span class="line">      wx.hideLoading()</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"获取失败"</span>, res)</span><br><span class="line">      wx.showToast(&#123;</span><br><span class="line">        title: <span class="string">'加载失败'</span>,</span><br><span class="line">        icon: none</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onLoad: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    wx.cloud.database().collection(<span class="string">'list'</span>).count()</span><br><span class="line">    .then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"数据总条数"</span>,res)</span><br><span class="line">      totalNum = res.total</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">this</span>.getDataList()</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面初次渲染完成</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onReady: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面显示</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onShow: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面隐藏</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onHide: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面卸载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onUnload: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面相关事件处理函数--监听用户下拉动作</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onPullDownRefresh: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面上拉触底事件的处理函数</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onReachBottom: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.getDataList()</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 用户点击右上角分享</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onShareAppMessage: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h2 id="7、登录注册—login1204—user"><a href="#7、登录注册—login1204—user" class="headerlink" title="7、登录注册—login1204—user"></a>7、登录注册—login1204—user</h2><h3 id="1-注册—index"><a href="#1-注册—index" class="headerlink" title="(1) 注册—index"></a>(1) 注册—index</h3><ol>
<li><p>初始化云开发环境—wx.cloud.init</p>
</li>
<li><p>获取用户输入的信息—bindinput</p>
</li>
<li><p>添加校验—if</p>
</li>
<li><p>通过单击注册添加到数据库—bindtap</p>
</li>
<li><p>优化用户体验，增加友好的提示—wx.showToast</p>
</li>
<li><p>跳转到登录页面—wx.navigateTo({})</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.wxml</span></span><br><span class="line">输入用户名</span><br><span class="line">&lt;input <span class="class"><span class="keyword">class</span></span>=<span class="string">"input"</span> bindinput=<span class="string">"getName"</span>&gt;&lt;<span class="regexp">/input&gt;</span></span><br><span class="line"><span class="regexp">输入用户账号</span></span><br><span class="line"><span class="regexp">&lt;input class="input" bindinput="getZhangHao"&gt;&lt;/i</span>nput&gt;</span><br><span class="line">输入您的密码</span><br><span class="line">&lt;input <span class="class"><span class="keyword">class</span></span>=<span class="string">"input"</span> bindinput=<span class="string">"getMiMa"</span>&gt;&lt;<span class="regexp">/input&gt;</span></span><br><span class="line"><span class="regexp">&lt;button bindtap="zhuCe" type = "primary"&gt;注册&lt;/</span>button&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.wxss</span></span><br><span class="line">.input&#123;</span><br><span class="line">  border: <span class="number">1</span>px solid gainsboro;</span><br><span class="line">  margin: <span class="number">15</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//index.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">    name:<span class="string">""</span>,</span><br><span class="line">    zhangHao:<span class="string">""</span>,</span><br><span class="line">    miMa:<span class="string">""</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 获取用户名</span></span><br><span class="line">  getName(event)&#123;</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      name: event.detail.value</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 获取账号</span></span><br><span class="line">  getZhangHao(event) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      zhangHao: event.detail.value</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 获取密码</span></span><br><span class="line">  getMiMa(event) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      miMa: event.detail.value</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 注册</span></span><br><span class="line">  zhuCe()&#123;</span><br><span class="line">    <span class="keyword">let</span> name = <span class="keyword">this</span>.data.name;</span><br><span class="line">    <span class="keyword">let</span> zhangHao = <span class="keyword">this</span>.data.zhangHao;</span><br><span class="line">    <span class="keyword">let</span> miMa = <span class="keyword">this</span>.data.miMa;</span><br><span class="line">    <span class="comment">// 校验用户名</span></span><br><span class="line">    <span class="keyword">if</span>(name.length &lt; <span class="number">2</span>)&#123;</span><br><span class="line">      wx.showToast(&#123;</span><br><span class="line">        title: <span class="string">'用户名至少两位'</span>,</span><br><span class="line">        icon: <span class="string">'none'</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (name.length &gt; <span class="number">10</span>)&#123;</span><br><span class="line">      wx.showToast(&#123;</span><br><span class="line">        title: <span class="string">'用户名最多10位'</span>,</span><br><span class="line">        icon: <span class="string">'none'</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 校验账号</span></span><br><span class="line">    <span class="keyword">if</span> (zhangHao.length &lt; <span class="number">4</span>) &#123;</span><br><span class="line">      wx.showToast(&#123;</span><br><span class="line">        title: <span class="string">'账号至少四位'</span>,</span><br><span class="line">        icon: <span class="string">'none'</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 校验密码</span></span><br><span class="line">    <span class="keyword">if</span> (miMa.length &lt; <span class="number">4</span>)&#123;</span><br><span class="line">      wx.showToast(&#123;</span><br><span class="line">        title: <span class="string">'密码至少4位'</span>,</span><br><span class="line">        icon: <span class="string">'none'</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 注册功能的实现</span></span><br><span class="line">    wx.cloud.database().collection(<span class="string">"user"</span>).add(&#123;</span><br><span class="line">      data:&#123;</span><br><span class="line">        name: name,</span><br><span class="line">        zhanghao: zhangHao,</span><br><span class="line">        mima: miMa</span><br><span class="line">      &#125;,</span><br><span class="line">      success(res)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"添加成功"</span>,res)</span><br><span class="line">        wx.showToast(&#123;</span><br><span class="line">          title: <span class="string">'注册成功'</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        wx.navigateTo(&#123;</span><br><span class="line">          url: <span class="string">'../login/login'</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail(res)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"添加失败"</span>,res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//app.js</span></span><br><span class="line">App(&#123;</span><br><span class="line">  onLaunch: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    wx.cloud.init(&#123;</span><br><span class="line">      env: <span class="string">"codemao-7hcrz"</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  globalData: &#123;</span><br><span class="line">    userInfo: <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h3 id="2-登录—login"><a href="#2-登录—login" class="headerlink" title="(2) 登录—login"></a>(2) 登录—login</h3><ol>
<li><p>更改头部文件</p>
</li>
<li><p>初始化云开发环境—wx.cloud.init</p>
</li>
<li><p>获取用户输入的数据—bindinput</p>
</li>
<li><p>首次校验格式（非数据库）—if</p>
</li>
<li><p>二次校验格式（数据库）—wx.cloud.database().collection(“user”).where({zhanghao:zhanghao}).get({})</p>
</li>
<li><p>添加友好的提示（成功和失败）—wx.showToast({})</p>
</li>
<li><p>跳转到<strong>首页并传值</strong>—wx.navigateTo({url:”../home/home?name”+user.name})</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//login.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"usingComponents"</span>: &#123;&#125;,</span><br><span class="line">  <span class="string">"navigationBarTitleText"</span>: <span class="string">"登录"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//app.js</span></span><br><span class="line">App(&#123;</span><br><span class="line">  onLaunch: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    wx.cloud.init(&#123;</span><br><span class="line">      env: <span class="string">"codemao-7hcrz"</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  globalData: &#123;</span><br><span class="line">    userInfo: <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//login.wxml</span></span><br><span class="line">输入账号</span><br><span class="line">&lt;input <span class="class"><span class="keyword">class</span></span>=<span class="string">"input"</span> bindinput=<span class="string">"getZhangHao"</span>&gt;&lt;<span class="regexp">/input&gt;</span></span><br><span class="line"><span class="regexp">输入密码</span></span><br><span class="line"><span class="regexp">&lt;input class="input" password="true" bindinput="getMiMa"&gt;&lt;/i</span>nput&gt;</span><br><span class="line">&lt;button type=<span class="string">"primary"</span> bindtap=<span class="string">"login"</span>&gt;登录&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/login.wxss</span></span><br><span class="line"><span class="regexp">.input&#123;</span></span><br><span class="line"><span class="regexp">  border: 1px solid gainsboro;</span></span><br><span class="line"><span class="regexp">  margin: 20rpx;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/login.js</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  data:&#123;</span></span><br><span class="line"><span class="regexp">    zhanghao: "",</span></span><br><span class="line"><span class="regexp">    mima: ""</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ 获取输入的账号</span></span><br><span class="line"><span class="regexp">  getZhangHao(event)&#123;</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      zhanghao: event.detail.value</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ 获取输入的密码</span></span><br><span class="line"><span class="regexp">  getMiMa(event) &#123;</span></span><br><span class="line"><span class="regexp">    this.setData(&#123;</span></span><br><span class="line"><span class="regexp">      mima: event.detail.value</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ 点击登录</span></span><br><span class="line"><span class="regexp">  login() &#123;</span></span><br><span class="line"><span class="regexp">    let zhanghao = this.data.zhanghao</span></span><br><span class="line"><span class="regexp">    let mima = this.data.mima</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ 校验</span></span><br><span class="line"><span class="regexp">    if (zhanghao.length &lt; 4)&#123;</span></span><br><span class="line"><span class="regexp">      wx.showToast(&#123;</span></span><br><span class="line"><span class="regexp">        title: '账号不能小于4位',</span></span><br><span class="line"><span class="regexp">        icon: 'none'</span></span><br><span class="line"><span class="regexp">      &#125;)</span></span><br><span class="line"><span class="regexp">      return</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    if (mima.length &lt; 4) &#123;</span></span><br><span class="line"><span class="regexp">      wx.showToast(&#123;</span></span><br><span class="line"><span class="regexp">        title: '密码不能小于4位',</span></span><br><span class="line"><span class="regexp">        icon: 'none'</span></span><br><span class="line"><span class="regexp">      &#125;)</span></span><br><span class="line"><span class="regexp">      return</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ 登录</span></span><br><span class="line"><span class="regexp">    wx.cloud.database().collection("user")</span></span><br><span class="line"><span class="regexp">    .where(&#123;</span></span><br><span class="line"><span class="regexp">      zhanghao: zhanghao,</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/ mima: mima</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">    .get(&#123;</span></span><br><span class="line"><span class="regexp">      success(res)&#123;</span></span><br><span class="line"><span class="regexp">        console.log("获取数据成功",res.data)</span></span><br><span class="line"><span class="regexp">        let user = res.data[0]</span></span><br><span class="line"><span class="regexp">        if(mima  == user.mima)&#123;</span></span><br><span class="line"><span class="regexp">          wx.showToast(&#123;</span></span><br><span class="line"><span class="regexp">            title: '登录成功',</span></span><br><span class="line"><span class="regexp">          &#125;)</span></span><br><span class="line"><span class="regexp">          wx.navigateTo(&#123;</span></span><br><span class="line"><span class="regexp">            /</span><span class="regexp">/ url: '/</span>pages/home/home<span class="string">', 都可以</span></span><br><span class="line"><span class="string">            url: '</span>../home/home?name=<span class="string">' + user.name,</span></span><br><span class="line"><span class="string">          &#125;)</span></span><br><span class="line"><span class="string">        &#125;else&#123;</span></span><br><span class="line"><span class="string">          wx.showToast(&#123;</span></span><br><span class="line"><span class="string">            title: '</span>账号或密码不正确<span class="string">',</span></span><br><span class="line"><span class="string">            icon: '</span>none<span class="string">'</span></span><br><span class="line"><span class="string">          &#125;)</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      fail(res)&#123;</span></span><br><span class="line"><span class="string">        console.log("获取数据成功", res)</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<h3 id="3-首页—home"><a href="#3-首页—home" class="headerlink" title="(3) 首页—home"></a>(3) 首页—home</h3><ol>
<li><p>接受登录页面传递过来的值—onload</p>
</li>
<li><p>显示到页面上面–</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//home.wxml</span></span><br><span class="line">&lt;text&gt;&#123;&#123;name&#125;&#125;，欢迎使用CodeMao开发的小程序&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/home.js</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ pages/</span>home/home.js</span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  data: &#123;</span><br><span class="line">    name: <span class="string">''</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onLoad: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(options.name)</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      name: options.name</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="4-个人中心页"><a href="#4-个人中心页" class="headerlink" title="(4) 个人中心页"></a>(4) 个人中心页</h3><ol>
<li><p>设置top文字—“navigationBarTitleText”: “个人中心”</p>
</li>
<li><p>两种显示状态—onshow—wx:if</p>
<ul>
<li>登录时候的展示内容</li>
<li>未登录时候的展示内容</li>
</ul>
</li>
<li><p>设置登录缓存—wx.setStorageSync(‘user’, user)</p>
<ul>
<li>修改登录页面跳转到个人中心页面</li>
<li>添加缓存</li>
</ul>
</li>
<li><p>增添退出功能</p>
<ul>
<li>删除缓存—wx.getStorageSync(‘user’,null)</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//me.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"usingComponents"</span>: &#123;&#125;,</span><br><span class="line">  <span class="string">"navigationBarTitleText"</span>: <span class="string">"个人中心"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//me.wxml</span></span><br><span class="line">&lt;!-- 未登录状态 --&gt;</span><br><span class="line">&lt;view wx:<span class="keyword">if</span>=<span class="string">"&#123;&#123;!loginOk&#125;&#125;"</span>&gt;</span><br><span class="line">&lt;button type=<span class="string">"primary"</span> bindtap=<span class="string">"denglu"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"zhuce"</span>&gt;登录&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;button type="primary" bindtap="zhuce" class="zhuce"&gt;注册&lt;/</span>button&gt;</span><br><span class="line">&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;!-- 登录成功 --&gt;</span></span><br><span class="line"><span class="regexp">&lt;view wx:else class="login-ok"&gt;</span></span><br><span class="line"><span class="regexp">  &lt;text&gt;登录成功&lt;/</span>text&gt;</span><br><span class="line">  &lt;view&gt;<span class="xml"><span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123;name&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span>&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">  &lt;button bindtap="tuichu" type="primary"&gt;退出&lt;/</span>button&gt;</span><br><span class="line">&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/me.wxss</span></span><br><span class="line"><span class="regexp">.zhuce&#123;</span></span><br><span class="line"><span class="regexp">  margin-top: 50rpx;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.login-ok&#123;</span></span><br><span class="line"><span class="regexp">  text-align: center</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/me.js</span></span><br><span class="line"><span class="regexp">Page(&#123;</span></span><br><span class="line"><span class="regexp">  data:&#123;</span></span><br><span class="line"><span class="regexp">    loginOk: false</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ 去登录页</span></span><br><span class="line"><span class="regexp">  denglu()&#123;</span></span><br><span class="line"><span class="regexp">    wx.navigateTo(&#123;</span></span><br><span class="line"><span class="regexp">      url: '/</span>pages/login/login<span class="string">',</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  // 去注册页</span></span><br><span class="line"><span class="string">  zhuce()&#123;</span></span><br><span class="line"><span class="string">    wx.navigateTo(&#123;</span></span><br><span class="line"><span class="string">      url: '</span>/pages/index/index<span class="string">',</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  onShow()&#123;</span></span><br><span class="line"><span class="string">    let user = wx.getStorageSync('</span>user<span class="string">')</span></span><br><span class="line"><span class="string">    if (user &amp;&amp; user.name)&#123;</span></span><br><span class="line"><span class="string">      this.setData(&#123;</span></span><br><span class="line"><span class="string">        loginOk: true,</span></span><br><span class="line"><span class="string">        name: user.name</span></span><br><span class="line"><span class="string">      &#125;)</span></span><br><span class="line"><span class="string">    &#125;else &#123;</span></span><br><span class="line"><span class="string">      this.setData(&#123;</span></span><br><span class="line"><span class="string">        loginOk: false</span></span><br><span class="line"><span class="string">      &#125;)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  // 退出登录</span></span><br><span class="line"><span class="string">  tuichu()&#123;</span></span><br><span class="line"><span class="string">    wx.setStorageSync('</span>user<span class="string">', null)</span></span><br><span class="line"><span class="string">    let user = wx.getStorageSync('</span>user<span class="string">')</span></span><br><span class="line"><span class="string">    if (user &amp;&amp; user.name) &#123;</span></span><br><span class="line"><span class="string">      this.setData(&#123;</span></span><br><span class="line"><span class="string">        loginOk: true,</span></span><br><span class="line"><span class="string">        name: user.name</span></span><br><span class="line"><span class="string">      &#125;)</span></span><br><span class="line"><span class="string">    &#125; else &#123;</span></span><br><span class="line"><span class="string">      this.setData(&#123;</span></span><br><span class="line"><span class="string">        loginOk: false</span></span><br><span class="line"><span class="string">      &#125;)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//login.js</span></span><br><span class="line"><span class="string">// 登录</span></span><br><span class="line"><span class="string">    wx.cloud.database().collection("user")</span></span><br><span class="line"><span class="string">      .where(&#123;</span></span><br><span class="line"><span class="string">        zhanghao: zhanghao,</span></span><br><span class="line"><span class="string">        // mima: mima</span></span><br><span class="line"><span class="string">      &#125;)</span></span><br><span class="line"><span class="string">      .get(&#123;</span></span><br><span class="line"><span class="string">      success(res) &#123;</span></span><br><span class="line"><span class="string">        console.log("获取数据成功", res.data)</span></span><br><span class="line"><span class="string">        let user = res.data[0]</span></span><br><span class="line"><span class="string">        if (mima == user.mima) &#123;</span></span><br><span class="line"><span class="string">          wx.showToast(&#123;</span></span><br><span class="line"><span class="string">            title: '</span>登录成功<span class="string">',</span></span><br><span class="line"><span class="string">          &#125;)</span></span><br><span class="line"><span class="string">          wx.navigateTo(&#123;</span></span><br><span class="line"><span class="string">            // url: '</span>/pages/home/home<span class="string">', 都可以</span></span><br><span class="line"><span class="string">            // url: '</span>../home/home?name=<span class="string">' + user.name,</span></span><br><span class="line"><span class="string">            url: '</span>/pages/me/me<span class="string">'</span></span><br><span class="line"><span class="string">          &#125;)</span></span><br><span class="line"><span class="string">          // 保存用户登录状态---本地存储</span></span><br><span class="line"><span class="string">          wx.setStorageSync('</span>user<span class="string">', user)</span></span><br><span class="line"><span class="string">        &#125; else &#123;</span></span><br><span class="line"><span class="string">          wx.showToast(&#123;</span></span><br><span class="line"><span class="string">            title: '</span>账号或密码不正确<span class="string">',</span></span><br><span class="line"><span class="string">            icon: '</span>none<span class="string">'</span></span><br><span class="line"><span class="string">          &#125;)</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      fail(res) &#123;</span></span><br><span class="line"><span class="string">        console.log("获取数据成功", res)</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">  &#125;</span></span><br></pre></td></tr></table></figure>











</li>
</ol>
<h3 id="9-小程序上传内容-gt-2M"><a href="#9-小程序上传内容-gt-2M" class="headerlink" title="(9)小程序上传内容&gt;2M"></a>(9)小程序上传内容&gt;2M</h3><ol>
<li>解决方法一：<ol>
<li>分包，但是总包不能大于16M</li>
<li>或者用后台数据库图片</li>
</ol>
</li>
<li>解决方法二：<ol>
<li>压缩图片</li>
</ol>
</li>
</ol>
<h3 id="10-根据时间，小于等于3小时记单量为1，否则加1"><a href="#10-根据时间，小于等于3小时记单量为1，否则加1" class="headerlink" title="(10) 根据时间，小于等于3小时记单量为1，否则加1"></a>(10) 根据时间，小于等于3小时记单量为1，否则加1</h3><ul>
<li><p>计算出小时差和分钟差</p>
</li>
<li><p>先写特殊情况</p>
<ul>
<li>小时差&lt;0</li>
<li>小时差=0的时候<ul>
<li>分钟差&lt;=0</li>
<li>分钟差&gt;0</li>
</ul>
</li>
</ul>
</li>
<li><p>在按照分钟分</p>
<ul>
<li>如果分钟差==0</li>
<li>如果分钟差&gt;0</li>
<li>如果分钟差&lt;0</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 计算记单量</span></span><br><span class="line">  getJiDanLiang()&#123;</span><br><span class="line">    <span class="keyword">let</span> endtime = <span class="keyword">this</span>.data.endtime</span><br><span class="line">    <span class="keyword">let</span> arrivetime = <span class="keyword">this</span>.data.arrivetime</span><br><span class="line">    <span class="comment">// 结束时间</span></span><br><span class="line">    <span class="keyword">let</span> endhm = endtime.split(<span class="string">":"</span>)</span><br><span class="line">    <span class="comment">// 结束的小时</span></span><br><span class="line">    <span class="keyword">let</span> endh = <span class="built_in">parseInt</span>(endhm[<span class="number">0</span>])</span><br><span class="line">    <span class="comment">// 结束的分钟</span></span><br><span class="line">    <span class="keyword">let</span> endm = <span class="built_in">parseInt</span>(endhm[<span class="number">1</span>])</span><br><span class="line">    <span class="comment">// 到场时间</span></span><br><span class="line">    <span class="keyword">let</span> arrivehm = arrivetime.split(<span class="string">":"</span>)</span><br><span class="line">    <span class="comment">// 到场时间小时</span></span><br><span class="line">    <span class="keyword">let</span> arriveh = <span class="built_in">parseInt</span>(arrivehm[<span class="number">0</span>]) </span><br><span class="line">    <span class="comment">// 到场时间分</span></span><br><span class="line">    <span class="keyword">let</span> arrivem = <span class="built_in">parseInt</span>(arrivehm[<span class="number">1</span>])</span><br><span class="line">    <span class="comment">// 相差的小时数</span></span><br><span class="line">    <span class="keyword">let</span> hourcha =  endh - arriveh</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"hourcha"</span>, hourcha)</span><br><span class="line">    <span class="comment">// 相差的分钟数</span></span><br><span class="line">    <span class="keyword">let</span> minutecha = endm - arrivem</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算计单量</span></span><br><span class="line">    <span class="keyword">let</span> jidanliang = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (hourcha &lt; <span class="number">0</span>)&#123;</span><br><span class="line">      jidanliang = <span class="number">0</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (hourcha == <span class="number">0</span> &amp;&amp; minutecha &lt;= <span class="number">0</span>)&#123;</span><br><span class="line">      jidanliang = <span class="number">0</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (hourcha == <span class="number">0</span> &amp;&amp; minutecha &gt; <span class="number">0</span>)&#123;</span><br><span class="line">      jidanliang = <span class="number">1</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="comment">// 此时校验的是小时差 &gt; 0</span></span><br><span class="line">      <span class="comment">// 当分钟差 == 0的时候</span></span><br><span class="line">      <span class="keyword">if</span> (minutecha == <span class="number">0</span>)&#123;</span><br><span class="line">        jidanliang = <span class="built_in">Math</span>.ceil(hourcha / <span class="number">3</span>)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 当分钟差 &gt; 0</span></span><br><span class="line">      <span class="keyword">if</span> (minutecha &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (hourcha % <span class="number">3</span> == <span class="number">0</span>)&#123;</span><br><span class="line">          jidanliang = <span class="built_in">Math</span>.ceil(hourcha / <span class="number">3</span>) + <span class="number">1</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">          jidanliang = <span class="built_in">Math</span>.ceil(hourcha / <span class="number">3</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 当分钟差 &lt; 0</span></span><br><span class="line">      <span class="keyword">if</span> (minutecha &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (hourcha == <span class="number">3</span>)&#123;</span><br><span class="line">          jidanliang = <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        jidanliang = <span class="built_in">Math</span>.ceil(hourcha / <span class="number">3</span>)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      jidanliang: jidanliang</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"getjidanliang==&gt;"</span> + jidanliang)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="11-input只能输入数字"><a href="#11-input只能输入数字" class="headerlink" title="(11) input只能输入数字"></a>(11) input只能输入数字</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 发票金额</span></span><br><span class="line">  getFaPiaoJinE(e)&#123;</span><br><span class="line">    <span class="comment">//发票金额 要做验证只能输入数字</span></span><br><span class="line">    <span class="keyword">var</span> regNum = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'[0-9]'</span>, <span class="string">'g'</span>);</span><br><span class="line">    <span class="keyword">var</span> rsNum = regNum.exec(e.detail.value);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!rsNum) &#123;</span><br><span class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        wx.showToast(&#123;</span><br><span class="line">          title: <span class="string">'只能输入数字'</span>,</span><br><span class="line">          icon: <span class="string">'none'</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>





<h3 id="12-查询数据的时候排序"><a href="#12-查询数据的时候排序" class="headerlink" title="(12)  查询数据的时候排序"></a>(12)  查询数据的时候排序</h3><ol>
<li><p>orderBy</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">wx.cloud.database().collection(event.name).orderBy(<span class="string">'index'</span>,<span class="string">'asc'</span>).get(&#123;</span><br><span class="line">    success(res) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"排序成功"</span>, res)</span><br><span class="line">    &#125;,</span><br><span class="line">    fail(res) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"排序失败"</span>, res)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>





</li>
</ol>
<h1 id="二、实战项目—demo"><a href="#二、实战项目—demo" class="headerlink" title="二、实战项目—demo"></a>二、实战项目—demo</h1><h2 id="1、-input-和-textarea"><a href="#1、-input-和-textarea" class="headerlink" title="1、 input 和 textarea"></a>1、 input 和 textarea</h2><ol>
<li>input就是当行输入框</li>
<li>textarea就是多行输入框</li>
</ol>
<h2 id="2、-页面跳转传参"><a href="#2、-页面跳转传参" class="headerlink" title="2、 页面跳转传参"></a>2、 页面跳转传参</h2><ol>
<li><p>传递前的页面用json转换成字符串：JSON.stringify(e.detail.value)</p>
</li>
<li><p>传递后的页面用json格式接受： let params = JSON.parse(e.obj)</p>
</li>
<li><p>参考文献：<a href="https://www.cnblogs.com/helena000/p/11499043.html" target="_blank" rel="noopener">https://www.cnblogs.com/helena000/p/11499043.html</a></p>
</li>
<li><p>案例</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 传参数页面</span></span><br><span class="line"><span class="comment">// 提交</span></span><br><span class="line">  submit(e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"submit==&gt;"</span>, e.detail.value)</span><br><span class="line">    <span class="keyword">let</span> condition = e.detail.value</span><br><span class="line">    wx.navigateTo(&#123;</span><br><span class="line">      url: <span class="string">'/pages/queryCondition/queryCondition?obj='</span> + <span class="built_in">JSON</span>.stringify(e.detail.value),</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接受参数页面</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  onLoad(e)&#123;</span><br><span class="line">    <span class="keyword">let</span> params = <span class="built_in">JSON</span>.parse(e.obj)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"onLoad"</span>, params.username)</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h2 id="3、-重置页面的方法"><a href="#3、-重置页面的方法" class="headerlink" title="3、 重置页面的方法"></a>3、 重置页面的方法</h2><ol>
<li><p>方法一：重置数据</p>
</li>
<li><p>方法二：this.onLoad()</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// wxml</span></span><br><span class="line">&lt;form bindreset=<span class="string">"reset"</span>&gt;</span><br><span class="line">	&lt;button type=<span class="string">"primary"</span> form-type=<span class="string">"reset"</span>&gt;重置&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>form&gt;    </span><br><span class="line"></span><br><span class="line"><span class="comment">// 重置数据</span></span><br><span class="line">  reset(e)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"reset==&gt;"</span>, e)</span><br><span class="line">    <span class="keyword">this</span>.onLoad()</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="4、-data-的用法"><a href="#4、-data-的用法" class="headerlink" title="4、 data-的用法"></a>4、 data-的用法</h2><ol>
<li><p>作用：传递前台页面的值，一般有bindtap连用</p>
</li>
<li><p>data-后面的东西不区分大小写，接受到的<strong>名称一律小写</strong></p>
</li>
<li><p>案例</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.wxml</span></span><br><span class="line">&lt;view bindtap=<span class="string">"getData"</span> data-id=<span class="string">"123"</span>&gt;</span><br><span class="line">  点我获取data</span><br><span class="line">&lt;<span class="regexp">/view&gt;</span></span><br><span class="line"><span class="regexp">&lt;view&gt;&#123;&#123;id&#125;&#125;&lt;/</span>view&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">    id: <span class="string">""</span></span><br><span class="line">  &#125;,</span><br><span class="line">  getData(e)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"getData==&gt;"</span>, e.currentTarget.dataset)</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      id: e.currentTarget.dataset.id</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h2 id="5、-form的用法"><a href="#5、-form的用法" class="headerlink" title="5、 form的用法"></a>5、 form的用法</h2><ol>
<li><p>bindsumit</p>
</li>
<li><p>bindreset</p>
</li>
<li><p><strong>通过name获取value的值</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.wxml</span></span><br><span class="line">&lt;form bindsubmit=<span class="string">"submit"</span> bindreset=<span class="string">"reset"</span>&gt;</span><br><span class="line">  &lt;input name=<span class="string">"input"</span> value=<span class="string">"&#123;&#123;input&#125;&#125;"</span>&gt;&lt;<span class="regexp">/input&gt;</span></span><br><span class="line"><span class="regexp">  &lt;button form-type="submit" type="primary"&gt;submit&lt;/</span>button&gt;</span><br><span class="line">  &lt;button form-type=<span class="string">"reset"</span> type=<span class="string">"primary"</span>&gt;reset&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>form&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data:&#123;</span><br><span class="line">    input: <span class="string">"input"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  submit(e)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"submit==&gt;"</span>, e)</span><br><span class="line">  &#125;,</span><br><span class="line">  reset(e)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"reset==&gt;"</span>, e)</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      input: <span class="string">""</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h2 id="6、-手机号正则—2020"><a href="#6、-手机号正则—2020" class="headerlink" title="6、 手机号正则—2020"></a>6、 手机号正则—2020</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 校验手机号</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="regexp">/^1[3-9]\d&#123;9&#125;$/</span>.test(phone)) &#123;</span><br><span class="line">    wx.showToast(&#123;</span><br><span class="line">        title: <span class="string">'请输入正确的手机格式'</span>,</span><br><span class="line">        icon: <span class="string">'none'</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7、picker的用法"><a href="#7、picker的用法" class="headerlink" title="7、picker的用法"></a>7、picker的用法</h2><ol>
<li>种类（mode=””）<ul>
<li>单列：selector</li>
<li>多列：multiSelector</li>
<li>时间：time</li>
<li>日期：date</li>
<li>省市区：region</li>
</ul>
</li>
<li>案例<ul>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/component/picker.html" target="_blank" rel="noopener">参考官方文档</a></li>
</ul>
</li>
</ol>
<h2 id="8、-页面手机屏幕"><a href="#8、-页面手机屏幕" class="headerlink" title="8、 页面手机屏幕"></a>8、 页面手机屏幕</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">app.wxss</span><br><span class="line">page&#123;</span><br><span class="line">  height:100%</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;每一个页面的大容器--防止有超出部分</span><br><span class="line">min-height:100%</span><br></pre></td></tr></table></figure>

<h2 id="9、-校验表单中数据是否填写完整"><a href="#9、-校验表单中数据是否填写完整" class="headerlink" title="9、 校验表单中数据是否填写完整"></a>9、 校验表单中数据是否填写完整</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">in</span> form) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!form[item]) &#123; <span class="comment">//验证form表单是否填写完整</span></span><br><span class="line">        wx.showToast(&#123;</span><br><span class="line">            title: <span class="string">'请将信息填写完整'</span>,</span><br><span class="line">            icon: <span class="string">'none'</span>,</span><br><span class="line">            duration: <span class="number">1000</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="10、-单选按钮—test"><a href="#10、-单选按钮—test" class="headerlink" title="10、 单选按钮—test"></a>10、 单选按钮—test</h2><ol>
<li>radio-group</li>
<li>radio</li>
</ol>
<h2 id="11、-input-文字显示一半"><a href="#11、-input-文字显示一半" class="headerlink" title="11、 input 文字显示一半"></a>11、 input 文字显示一半</h2><ol>
<li><p>input中添加一个view</p>
</li>
<li><p>设置input宽高都是100%</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;add.wxml</span><br><span class="line"> &lt;view class&#x3D;&quot;item&quot;&gt;</span><br><span class="line">    &lt;label class&#x3D;&quot;item_1&quot;&gt;散客提成&lt;&#x2F;label&gt;:</span><br><span class="line">    &lt;view class&#x3D;&quot;item_2&quot;&gt;</span><br><span class="line">      &lt;input name&#x3D;&quot;ticheng&quot; placeholder&#x3D;&quot;按照提成公式填写&quot;&gt;&lt;&#x2F;input&gt;</span><br><span class="line">    &lt;&#x2F;view&gt;</span><br><span class="line">  &lt;&#x2F;view&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;add.wxss</span><br><span class="line">.item_2 &#123;</span><br><span class="line">  flex: 8;</span><br><span class="line">  padding: 10rpx;</span><br><span class="line">&#125;</span><br><span class="line">.item_2 input&#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  width: 100%;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




</li>
</ol>
<h2 id="12、-下拉触底函数不触发"><a href="#12、-下拉触底函数不触发" class="headerlink" title="12、 下拉触底函数不触发"></a>12、 下拉触底函数不触发</h2><ol>
<li><p>将页面的height不要设成100%</p>
</li>
<li><p>在该页面的json中增加下拉距离单位像素</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"onReachBottomDistance": 100</span><br></pre></td></tr></table></figure>


</li>
</ol>
<h2 id="13、-开发时注意"><a href="#13、-开发时注意" class="headerlink" title="13、 开发时注意"></a>13、 开发时注意</h2><ol>
<li>云开发对数据进行<strong>增删改查的时候，最好都用云函数</strong>，但是上线20个，那<strong>删除和修改一定要用云函数</strong>，否则数据库的权限即使你在你这修改了，但是上线之后还是没有权限的。</li>
</ol>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Code Mao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/08/30/weChat/">http://yoursite.com/2020/08/30/weChat/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">嗨，毛毛</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/09/20/Oracle/"><img class="prev-cover" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Oracle</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/26/%E5%B0%8F%E7%A8%8B%E5%BA%8F---%E5%A6%82%E4%BD%95%E4%B8%8A%E4%BC%A0%E4%BB%A3%E7%A0%81%EF%BC%9F/"><img class="next-cover" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">小程序---如何上传代码？</div></div></a></div></nav><hr><div id="post-comment"><div class="comment-head"><div class="comment-headling"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div class="comments-items-1" data-name="Valine"><div class="vcomment" id="vcomment"></div><script>function loadvaline () {  
  var requestSetting = function (from,set) {
    var from = from
    var setting = set.split(',').filter(function(item){
    return from.indexOf(item) > -1
    });
    setting = setting.length == 0 ? from :setting;
    return setting
  }

  var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
  var requiredFields = requestSetting(['nick','mail'],'nick,mail')

  function initValine () {
    window.valine = new Valine({
      el:'#vcomment',
      appId: 'eg5a7jo5eLWGANcqyuiW4yef-gzGzoHsz',
      appKey: 'OYXz3MhVaHEHVmt53Mwa1Yfw',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: guestInfo,
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      requiredFields: requiredFields
    });
  }
  loadScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || false) {
  window.addEventListener('load', loadvaline)
}
else {
  function loadOtherComment () {
    loadvaline()
  }
}</script></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Code Mao</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script defer id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script></body></html>